<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>TweakUI – Theme Generator</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/feather-icons"></script>

<style>
:root {
  --primary:#6366f1;
  --secondary:#4f46e5;
  --bg:#020617;
  --surface:#020617;
  --text:#e5e7eb;
  --radius:12px;
}
</style>
</head>

<body class="bg-[var(--bg)] text-[var(--text)] min-h-screen flex">

<!-- SIDEBAR -->
<aside class="w-80 border-r border-white/10 p-6 space-y-4 bg-black/40">
  <h1 class="text-xl font-bold flex items-center gap-2 mb-6">
    <i data-feather="sliders" class="w-5 h-5"></i>
    Theme Generator
  </h1>

  <div class="space-y-4">
    <div>
      <label class="flex items-center gap-2 text-sm opacity-70">
        <i data-feather="droplet"></i> Primary
      </label>
      <input type="color" id="primary" class="w-full h-10 mt-1 rounded">
    </div>

    <div>
      <label class="flex items-center gap-2 text-sm opacity-70">
        <i data-feather="layers"></i> Secondary
      </label>
      <input type="color" id="secondary" class="w-full h-10 mt-1 rounded">
    </div>

    <div>
      <label class="flex items-center gap-2 text-sm opacity-70">
        <i data-feather="moon"></i> Background
      </label>
      <input type="color" id="bg" class="w-full h-10 mt-1 rounded">
    </div>

    <div>
      <label class="flex items-center gap-2 text-sm opacity-70">
        <i data-feather="type"></i> Text
      </label>
      <input type="color" id="text" class="w-full h-10 mt-1 rounded">
    </div>

    <div>
      <label class="flex items-center gap-2 text-sm opacity-70">
        <i data-feather="corner-left-down"></i> Border radius
      </label>
      <input type="range" min="4" max="24" id="radius" class="w-full">
    </div>
  </div>

  <button onclick="toggleMode()"
    class="flex items-center justify-center gap-2 w-full py-2 rounded bg-white/10 hover:bg-white/20">
    <i data-feather="sun"></i>
    Toggle light / dark
  </button>

  <button onclick="exportCSS()"
    class="flex items-center justify-center gap-2 w-full py-2 rounded bg-indigo-600 hover:bg-indigo-500 font-semibold">
    <i data-feather="download"></i>
    Export CSS
  </button>

  <button onclick="exportTW()"
    class="flex items-center justify-center gap-2 w-full py-2 rounded border border-white/10 hover:bg-white/10">
    <i data-feather="package"></i>
    Tailwind Config
  </button>

  <a href="/app.html" class="block text-center text-sm opacity-60 hover:opacity-100">
    ← Back
  </a>
</aside>

<!-- CONTENT -->
<main class="flex-1 p-10 space-y-10">

<section class="grid md:grid-cols-3 gap-6">
  <div class="p-6 rounded-xl bg-[var(--surface)] border border-white/10">
    <h3 class="font-semibold mb-2">Card</h3>
    <p class="text-sm opacity-70">Preview component</p>
    <button class="mt-4 px-4 py-2 rounded bg-[var(--primary)] text-white">
      Primary
    </button>
  </div>

  <div class="p-6 rounded-xl bg-[var(--surface)] border border-white/10">
    <input class="w-full px-3 py-2 rounded bg-black/40 border border-white/10
      focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"
      placeholder="Input field"/>
  </div>

  <div class="p-6 rounded-xl bg-[var(--surface)] border border-white/10">
    <p id="contrast" class="text-sm"></p>
  </div>
</section>

<section>
  <h2 class="text-xl font-semibold mb-2">CSS Variables</h2>
  <pre id="output"
    class="bg-black/50 border border-white/10 rounded-lg p-4 text-sm overflow-x-auto"></pre>
</section>

</main>

<script>
const root = document.documentElement;
const ids = ["primary","secondary","bg","text","radius"];
const contrastEl = document.getElementById("contrast");

ids.forEach(id => {
  const el = document.getElementById(id);
  el.value = getVar("--" + id);
  el.addEventListener("input", update);
});

function getVar(v) {
  return getComputedStyle(root).getPropertyValue(v).trim();
}

function setVar(v,val) {
  root.style.setProperty(v,val);
}

function update() {
  setVar("--primary", primary.value);
  setVar("--secondary", secondary.value);
  setVar("--bg", bg.value);
  setVar("--text", text.value);
  setVar("--radius", radius.value + "px");
  checkContrast();
  updateOutput();
  save();
}

function toggleMode() {
  const dark = getVar("--bg") === "#020617";
  setVar("--bg", dark ? "#ffffff" : "#020617");
  setVar("--text", dark ? "#020617" : "#e5e7eb");
  bg.value = getVar("--bg");
  text.value = getVar("--text");
  update();
}

function contrast(a,b) {
  const l = c => {
    c = c.match(/\w\w/g).map(x=>parseInt(x,16)/255)
      .map(v=>v<=.03928?v/12.92:((v+.055)/1.055)**2.4);
    return .2126*c[0]+.7152*c[1]+.0722*c[2];
  }
  const A=l(a.slice(1)), B=l(b.slice(1));
  return ((Math.max(A,B)+.05)/(Math.min(A,B)+.05)).toFixed(2);
}

function checkContrast() {
  const ratio = contrast(bg.value, text.value);
  contrastEl.innerHTML =
    ratio < 4.5
      ? `<span class="flex items-center gap-2 text-red-400">
           <i data-feather="alert-triangle"></i> Contrast ${ratio} (Low)
         </span>`
      : `<span class="flex items-center gap-2 text-green-400">
           <i data-feather="check-circle"></i> Contrast ${ratio} (OK)
         </span>`;
  feather.replace();
}

function updateOutput() {
  output.textContent = `
:root {
  --primary: ${getVar("--primary")};
  --secondary: ${getVar("--secondary")};
  --bg: ${getVar("--bg")};
  --text: ${getVar("--text")};
  --radius: ${getVar("--radius")};
}`.trim();
}

function exportCSS() {
  navigator.clipboard.writeText(output.textContent);
  alert("CSS copied");
}

function exportTW() {
  const cfg = `
theme: {
  extend: {
    colors: {
      primary: '${getVar("--primary")}',
      secondary: '${getVar("--secondary")}'
    },
    borderRadius: {
      ui: '${getVar("--radius")}'
    }
  }
}`.trim();
  navigator.clipboard.writeText(cfg);
  alert("Tailwind config copied");
}

function save() {
  localStorage.setItem("tweakui-theme", output.textContent);
}

update();
feather.replace();
</script>

</body>
</html>
